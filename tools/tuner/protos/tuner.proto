syntax = "proto3";

package tuner;

option go_package = "./grpc/tuner;tuner";

service Tuner {
  rpc RequestEPDInfo(EPDInfoRequest) returns (EPDInfo);
  rpc StreamEPD(EPDStreamRequest) returns (stream EPDLine); 
  rpc RequestJob(JobRequest) returns (JobResponse);
  rpc RegisterResult(ResultRequest) returns (ResultAck);
}

message EPDInfoRequest {}

message EPDInfo {
  string filename = 1;
  bytes checksum = 2;
}

message EPDStreamRequest {}

message EPDLine {
  string line = 1;
}

message JobRequest {}

message JobResponse {
  bytes uuid = 1;
  int32 epoch = 2;
  int32 start = 3;
  int32 end = 4;
  bytes checksum = 5;
  double k = 6;
  repeated double coefficients = 7;
}

message ResultRequest {
  bytes uuid = 1;
  bytes checksum = 2;
  repeated double gradients = 3;
}

message ResultAck {}
